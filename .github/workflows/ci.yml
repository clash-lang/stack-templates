on:
  push:
    branches:
      - main
  pull_request:
    branches:
      - main
jobs:
  build:
    runs-on: ubuntu-latest
    strategy:
      matrix:
        container: ['ubuntu:18.04', 'ubuntu:20.04']
    steps:
      - uses: actions/checkout@v2
      - name: Install stack
        run: |
          cat /etc/debian_version
          sudo apt update
          stack --help
          sudo apt install wget -y
          wget -q https://get.haskellstack.org/ -O stack_install.sh
          sudo sh stack_install.sh
      - name: Instantiate template
        run: |
          stack new clash-example-project \
            -p author-name:"Clash-team" \
            -p author-email:"clash-language@googlegroups.com" \
            -p copyright:"" \
            -p github-username:"clash-lang"
      - name: Test template
        run: |
          cd clash-example-project
          stack build
          stack test
          stack run clash -- Example.Project --vhdl
          

